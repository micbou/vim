version: "{build}"
environment:
    matrix:
        - arch: 32
          msvc: 11
        - arch: 32
          msvc: 12
        - arch: 32
          msvc: 14
        - arch: 64
          msvc: 11
        - arch: 64
          msvc: 12
        - arch: 64
          msvc: 14
matrix:
    allow_failures:
        - msvc: 14
install:
    # Install NSIS and update PATH
    - curl -fsSL -o nsis-3.0b2-setup.exe http://prdownloads.sourceforge.net/nsis/nsis-3.0b2-setup.exe
    - nsis-3.0b2-setup.exe /S
    - set PATH=C:\Program Files (x86)\NSIS;%PATH%
build_script:
    - python build.py --msvc %msvc% --arch %arch%
    - python install.py
test_script:
    - python test.py --msvc %msvc%
artifacts:
    - path: nsis/gvim.exe
      name: gvim
